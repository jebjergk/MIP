# 21. Parallel Worlds

A "what-if" laboratory for your trading rules. Parallel Worlds replays each day's real market data through alternative rule sets and shows you what *would* have happened — without risking a single dollar. It's like having a time machine that lets you test different decisions after the fact.

## Real-World Analogy

Imagine you're a chess player reviewing a game you just finished. You wonder: "What if I'd moved the bishop instead of the knight on move 12?" You replay from that point and discover you would have won 3 moves sooner. That's Parallel Worlds — except instead of chess moves, you're replaying market days with different trading rules and seeing whether those rules would have made you more or less money.

## What Is Parallel Worlds?

Every day, MIP runs your portfolio using your current rules: signal thresholds, position sizes, entry timing, and risk gates. Parallel Worlds takes that *same* day's data and asks:

- **What if we'd used a looser signal filter?** — Would more trades have passed, and would they have been profitable?
- **What if we'd used a tighter filter?** — Would being pickier have avoided losses?
- **What if we'd used bigger (or smaller) positions?** — Would the extra (or reduced) exposure have helped?
- **What if we'd waited a day before entering?** — Would patience have gotten a better price?
- **What if we'd done nothing at all?** — Would staying in cash have been the best move?

Each of these alternatives is called a **scenario**. MIP runs all of them every day, records the results, and builds up a history so you can see which alternative rules — if any — *consistently* outperform your current approach.

> **Key point:** Parallel Worlds never changes your real portfolio. It's a read-only, retrospective analysis. Think of it as a flight simulator — you learn from the replay without any risk to the real plane.

## Policy Health Card (top of page)

This card gives you an instant, at-a-glance answer to the question: **"Are my current trading rules the best they can be?"** It combines signal confidence, regret, and stability into a single health assessment.

- **Health Badge** — A colored badge in the top-right corner:
  - **Healthy** (green) — No alternative rules reliably beat yours. Your approach is solid.
  - **Watch** (blue) — Some early signals, but nothing definitive yet. Keep an eye on it.
  - **Monitor** (orange) — A couple of scenarios are showing emerging patterns. Worth tracking.
  - **Review Suggested** (orange) — One scenario consistently outperforms. Consider studying it.
  - **Needs Attention** (red) — Multiple scenarios beat your rules. Time to investigate.

- **Stability Gauge (0–100)** — A progress bar showing how "settled" your rules are. 100 means every alternative scenario is noise — your rules are rock-solid. Example: "Stability 95/100, Very Stable" means 95% of alternative scenarios can't beat you.

- **Signal Breakdown** — Small colored badges showing how many scenarios fall into each confidence tier: Strong (green), Emerging (blue), Weak (orange), Noise (gray). Most of the time, you'll see mostly Noise badges — that's a good thing.

- **Biggest Regret Area** — Which category of rule changes accounts for the most regret (missed opportunity). Categories: Signal Filter, Position Size, Entry Timing, and Baseline (doing nothing). Example: "Baseline — $378 cumulative regret" means that over all the days measured, doing absolutely nothing (staying in cash) would have avoided $378 in losses.

- **Top Candidate** — If any scenario shows a non-noise signal, the strongest one appears here by name.

### Example: Reading the Policy Health Card

You open Parallel Worlds and see: **Healthy**, Stability **95/100**, Signal Breakdown: Noise: 7, Weak: 1. This tells you: your trading rules are performing well relative to alternatives. The one "Weak" scenario is not consistent enough to worry about. No action needed.

## Parallel Worlds Analysis (AI Narrative)

An AI-written summary that reads all the numbers and tells you what matters in plain English. The AI looks at today's scenario results, the decision traces, the regret trend, and writes a brief story about what happened and whether anything is worth paying attention to.

- **AI / Fallback Badge** — "AI" (purple gradient) means the narrative was generated by Snowflake Cortex AI, grounded in today's actual snapshot data. "Fallback" (gray) means the AI was unavailable and a simpler template-based summary was used instead.
- **Headline** — A one-sentence summary. Example: "All 8 scenarios matched actual performance — current rules are well-calibrated."
- **Gate Analysis** — Explains what happened at each decision gate (trust, risk, capacity, signal filters).
- **What-If Insights** — Bullet points for the most noteworthy scenario comparisons.
- **Regret Trend** — Whether regret is growing, shrinking, or flat over time.
- **Consideration** — A green-boxed suggestion — *not* a recommendation, but a thought to consider.

## Scenario Comparison Table

The main data table. Each row is one alternative universe — a different set of rules applied to the same day.

| Column | What It Means |
|--------|---------------|
| **What If We Had...** | The scenario's display name. Examples: "Looser Signal Filter (z-score -0.25)", "Bigger Positions (125%)", "Wait 1 Day Before Entering". |
| **Category** | Which type of rule was changed. Color-coded pill: Signal Filter (blue), Position Size (orange), Entry Timing (purple), Baseline (gray). |
| **Scenario PnL** | The profit or loss this scenario would have produced on that day. |
| **vs Actual** | Scenario PnL minus your real PnL. Green positive = scenario was better. Red negative = your real approach was better. $0 = identical. |
| **Equity Impact** | Same idea applied to total portfolio equity. Shows the dollar difference in end-of-day portfolio value. |
| **# Trades** | How many trades the scenario would have taken. Compare to your actual trade count. |
| **Signal** | The confidence badge for this scenario (see Signal Confidence section below). |

### Example: Reading a Row

You see: "Looser Signal Filter (z-score -0.25)", Category: Signal Filter, Scenario PnL: $142, vs Actual: +$42, # Trades: 5, Signal: Noise.

This means: if you had lowered your signal filter's z-score threshold by 0.25, you would have made $142 instead of your actual $100 — a $42 improvement. But the "Noise" badge tells you this is probably a one-day fluke, not a reliable pattern.

### Row Highlighting

Rows with a light green background are scenarios that **outperformed** your actual result on that day. This is purely visual — look at the Signal badge for the confidence assessment.

### Expandable Detail Row (Decision Trace)

Click the arrow on any row to expand it and see the **Decision Trace** — a human-readable explanation of what happened at each decision gate in that scenario.

- **Gate Cards** — Each card represents one decision gate (Threshold, Trust, Sizing, Timing, Baseline). The left border is color-coded: green = passed, red = blocked, orange = modified or delayed.
- **Status Label** — PASSED, BLOCKED, MODIFIED, DELAYED, or INFO.
- **Explanation Text** — Plain English. Example: "Delayed entry by 1 bar. No trades were affected." or "No signals changed eligibility."

## Signal Confidence Panel

Answers: **"Can I trust this scenario's results, or is it just random noise?"**

| Tier | Color | What It Means | Example |
|------|-------|---------------|---------|
| **Strong** | Green | Reliably outperforms — high win rate, many days of data, positive trend. Worth investigating seriously. | "Wins 75% over 15 days, avg +$12/day" |
| **Emerging** | Blue | A pattern is forming but too early to be sure. Keep watching. | "Wins 60% over 8 days — emerging pattern" |
| **Weak** | Orange | Some signal but not consistent. Could be meaningful, could be coincidence. | "Wins 45% but not yet consistent" |
| **Noise** | Gray | No meaningful difference. Either too few days of data, negligible dollar impact, or low win rate. Ignore it. | "Cumulative impact is negligible ($0.50)" |

> **Why Noise is good news:** If most scenarios show "Noise," that means the system couldn't find any rule changes that would reliably beat your current approach. Your rules are well-calibrated.

## Equity Curves Chart

A line chart showing how your portfolio equity evolved over time — and how each scenario *would have* evolved if you'd used different rules from the start.

- **Solid Blue Line** — Your actual portfolio equity over time. This is the ground truth.
- **Dashed Colored Lines** — Each represents one scenario. Above the solid line = that scenario would have produced more wealth. Below = your approach was better.
- **Hovering** — Hover over any point to see the exact equity value for each line on that date.
- **Convergence** — If all lines are bunched tightly, the scenarios didn't make much difference. If lines diverge widely, small rule changes had a big impact.

## Regret Attribution

A report card for your rule categories. Groups scenarios by type — Signal Filter, Position Size, Entry Timing, Baseline — and tells you which category accounts for the most missed opportunity.

- **Dominant Regret Driver** — A highlighted bar showing which rule category has the most cumulative regret. Example: "Baseline — $378 cumulative regret."
- **Category Cards** — One card per rule category, ranked by regret. Each shows: avg win rate, cumulative regret, best delta, best scenario name, and its confidence badge.
- **Blue left border** — The card with the blue left border is the dominant driver.

## Regret Heatmap

A color-coded grid showing how each scenario performed on each day.

- **Rows** — Each row is one scenario (by name).
- **Columns** — Each column is one date (most recent on the right).
- **Cell Color** — Green = scenario beat your actual result (positive delta). Red = your actual result was better (negative delta). Gray = no difference. The intensity shows how large the difference was.
- **Cell Value** — The dollar amount inside each cell. Hover for the full detail tooltip.

### Example: Reading the Heatmap

You look at the "Stay in Cash" row and see: Feb 3: -$45, Feb 4: +$20, Feb 5: +$60, Feb 6: -$12, Feb 7: +$15. This means: on Feb 3, your actual trading made $45 more than doing nothing — good day. On Feb 5, doing nothing would have saved you $60 — bad day for your trades. The mix of green and red tells you the cash scenario is not consistently better.

## Signal Tuning Tab

Think of this tab as a **radio dial** for your signal detection rules. It answers the question: **"What if I turned the sensitivity dial up or down — would I hear better signals or just more static?"**

When you click the **Signal Tuning** tab, MIP runs a full "parameter sweep" — it replays your trading history with dozens of slightly different signal filter settings and charts the results. Instead of testing just two or three alternatives (like the Overview tab does), it tests a whole range of settings in fine increments.

### Tuning Surface Charts

Each chart shows a parameter across its full range on the X-axis, with the cumulative PnL impact on the Y-axis. For example, the Z-Score Threshold surface shows what would have happened if you'd adjusted your signal filter by small amounts, from -0.50 (much looser) to +0.50 (much stricter).

- **Blue bars** — Your current setting. This is the zero-change baseline.
- **Green bars** — Settings that would have improved your results. The taller the bar, the more money you would have made with that setting.
- **Red bars** — Settings that would have hurt your results.
- **Optimal marker** (green dot, thick border) — The single best setting across the entire range.
- **Minimal Safe Tweak marker** (orange dot) — The smallest change from your current setting that still improves things. Think of it as "the least risky improvement."

> **Real-world analogy:** Imagine adjusting the thermostat in your house. The Tuning Surface shows you: "At 68° you're comfortable. At 70° you'd be slightly better. At 85° you'd be miserable." It finds the sweet spot.

### Recommendations Cards

Above the charts, you'll see recommendation cards ranked by confidence:

- **Conservative** (blue border) — The smallest change that would improve results. Low risk, modest reward.
- **Aggressive** (orange border) — The optimal change for maximum improvement. Higher potential reward, but a bigger change from current settings.

Each card shows:
- **Parameter** — Which setting and the change (e.g., "min_zscore_delta: 0 → -0.125")
- **Expected Impact** — Dollar amount of cumulative improvement
- **Win Rate** — Percentage of days the new setting would have outperformed
- **Confidence Badge** — Strong / Emerging / Weak / Noise (same as the Overview tab)
- **Safety Status** — "Ready for Review" (green) means it passed all safety checks. "Not Ready" (red) means it failed one or more.

Click any card to expand it and see:
- **Evidence details** — Daily delta, domain, observation count, and confidence reasoning
- **Safety Checklist** — Green checks and red crosses showing which safety tests passed or failed
- **Governance Buttons** — Approve / Reject / Dismiss buttons (currently disabled — governance workflow coming soon)

### Safety Checks Explained

Every recommendation must pass three safety checks before it's marked "Ready for Review":

| Check | What It Means | Why It Matters |
|-------|---------------|----------------|
| **Minimum Observation Days** | At least 5 days of sweep data | Prevents acting on too little information — like flipping a coin twice and concluding it's biased |
| **Trade Count Stability** | Changing this setting won't wildly increase/decrease trade count | A setting that makes you take 10x more trades might have a different risk profile entirely |
| **Regime Robustness** | Works in multiple market conditions (quiet, normal, volatile) | A setting that only helps in calm markets but hurts in volatile ones is risky |

### Regime Sensitivity Chart

A horizontal bar chart showing how each setting performs across different market conditions:

- **Quiet** (gray bars) — Low-volatility market days
- **Normal** (blue bars) — Average volatility days
- **Volatile** (orange bars) — High-volatility days

If a setting's bars are roughly even across all three regimes, it's **robust**. If it only shows high win rates in one regime, it's **fragile** and will be flagged.

## Portfolio Tuning Tab

This tab works exactly like Signal Tuning but for the **execution** side of your rules: how much to buy and when to enter.

### Position Sizing Surface

Tests what would happen if you had used different position sizes — from 50% of your current size to 150%. Answers: "Am I putting enough money into each trade, or too much?"

- Size 50% = half your current position size (more conservative)
- Size 100% = current setting (the blue bar)
- Size 150% = 50% larger positions (more aggressive)

### Entry Timing Surface

Tests what would happen if you had delayed entry by 0 to 3 bars (days). Answers: "Should I have waited a day before buying?"

- Delay 0 bars = enter immediately (current behavior)
- Delay 1 bar = wait one day after the signal
- Delay 2–3 bars = even more patience

> **Example:** You see the Delay 1 bar column at +$85 cumulative. This means: if you had waited one extra day before entering every trade, you would have saved $85 over the measured period — presumably by getting better entry prices.

### Portfolio Recommendations

Same card format as Signal Tuning, but covering sizing and timing parameters. Conservative recommendations suggest the smallest sizing or timing adjustment that helps; Aggressive recommendations suggest the optimal setting from the full sweep.

### Important: What These Tabs Are NOT

These tabs are **analysis tools**, not auto-pilots. They show you what *would have worked* in the past. The disclaimer at the top of each tab reads: *"Analysis only — these are suggestions based on historical replay, not instructions. All changes require human review and approval."*

The Approve/Reject buttons are intentionally disabled — they exist to show the future governance workflow, but no recommendations are automatically applied. You are always in control.

## What Parallel Worlds Is NOT

- **Not a crystal ball.** It looks backward, not forward. Past patterns may not repeat.
- **Not a recommendation to change your rules.** Even a "Strong" confidence signal is informational, not prescriptive.
- **Not live trading.** No money is at risk. It never places trades or modifies positions.
- **Not random.** Every simulation is **deterministic** — run it twice with the same data and you get the same result.
